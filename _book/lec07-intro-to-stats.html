<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>EEB313: Quantitative Methods in R for Biology - 8&nbsp; Introduction to inference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./projects.html" rel="next">
<link href="./lec06-exploratory-data-analysis.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./lec00-rstudio.html">Lectures</a></li><li class="breadcrumb-item"><a href="./lec07-intro-to-stats.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction to inference</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">EEB313: Quantitative Methods in R for Biology</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/EEB313/eeb313.github.io" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about-us.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The 2023 teaching team</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./downloadingR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Downloading R</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Lectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lec00-rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting started with RStudio and R Notebook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lec01-markdown-workflows.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Markdown, project workflows</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lec02-base-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Assignments, vectors, functions, and loops</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lec03-dataframes-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Dataframes and introduction to data wrangling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lec04-data-wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data wrangling with dplyr</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lec05-data-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data visualization with ggplot</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lec06-exploratory-data-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Exploratory data analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lec07-intro-to-stats.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction to inference</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Assignments</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Project</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Project description</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./databases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Some open-access databases</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#lesson-preamble" id="toc-lesson-preamble" class="nav-link active" data-scroll-target="#lesson-preamble"><span class="header-section-number">9</span> Lesson preamble</a>
  <ul class="collapse">
  <li><a href="#whats-chance-got-to-do-got-to-do-with-it" id="toc-whats-chance-got-to-do-got-to-do-with-it" class="nav-link" data-scroll-target="#whats-chance-got-to-do-got-to-do-with-it"><span class="header-section-number">9.1</span> What’s chance got to do … got to do … with it?</a></li>
  <li><a href="#random-variables-and-probability-distributions" id="toc-random-variables-and-probability-distributions" class="nav-link" data-scroll-target="#random-variables-and-probability-distributions"><span class="header-section-number">9.2</span> Random variables and probability distributions</a></li>
  <li><a href="#means-variances-and-other-moments" id="toc-means-variances-and-other-moments" class="nav-link" data-scroll-target="#means-variances-and-other-moments"><span class="header-section-number">9.3</span> Means, variances, and other moments</a>
  <ul class="collapse">
  <li><a href="#higher-moments" id="toc-higher-moments" class="nav-link" data-scroll-target="#higher-moments"><span class="header-section-number">9.3.1</span> Higher moments</a></li>
  </ul></li>
  <li><a href="#simulating-important-random-variables" id="toc-simulating-important-random-variables" class="nav-link" data-scroll-target="#simulating-important-random-variables"><span class="header-section-number">9.4</span> Simulating important random variables</a></li>
  <li><a href="#all-about-liklihood" id="toc-all-about-liklihood" class="nav-link" data-scroll-target="#all-about-liklihood"><span class="header-section-number">9.5</span> All about liklihood!</a>
  <ul class="collapse">
  <li><a href="#the-liklihood-function" id="toc-the-liklihood-function" class="nav-link" data-scroll-target="#the-liklihood-function"><span class="header-section-number">9.5.1</span> The liklihood function</a></li>
  <li><a href="#an-example-of-maximum-liklihood-estimation" id="toc-an-example-of-maximum-liklihood-estimation" class="nav-link" data-scroll-target="#an-example-of-maximum-liklihood-estimation"><span class="header-section-number">9.5.2</span> An example of maximum liklihood estimation</a></li>
  <li><a href="#an-aside-numerical-evaluation-of-the-liklihood" id="toc-an-aside-numerical-evaluation-of-the-liklihood" class="nav-link" data-scroll-target="#an-aside-numerical-evaluation-of-the-liklihood"><span class="header-section-number">9.5.3</span> An aside: numerical evaluation of the liklihood</a></li>
  </ul></li>
  <li><a href="#hypothesis-testing-theory" id="toc-hypothesis-testing-theory" class="nav-link" data-scroll-target="#hypothesis-testing-theory"><span class="header-section-number">9.6</span> Hypothesis testing: theory</a>
  <ul class="collapse">
  <li><a href="#null-and-alternative-hypotheses" id="toc-null-and-alternative-hypotheses" class="nav-link" data-scroll-target="#null-and-alternative-hypotheses"><span class="header-section-number">9.6.1</span> Null and alternative hypotheses</a></li>
  <li><a href="#test-statistics" id="toc-test-statistics" class="nav-link" data-scroll-target="#test-statistics"><span class="header-section-number">9.6.2</span> Test statistics</a></li>
  <li><a href="#how-do-we-do-this" id="toc-how-do-we-do-this" class="nav-link" data-scroll-target="#how-do-we-do-this"><span class="header-section-number">9.6.3</span> How do we do this?</a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals"><span class="header-section-number">9.6.4</span> Confidence intervals</a></li>
  </ul></li>
  <li><a href="#the-t-test-as-a-special-case-of-the-lrt" id="toc-the-t-test-as-a-special-case-of-the-lrt" class="nav-link" data-scroll-target="#the-t-test-as-a-special-case-of-the-lrt"><span class="header-section-number">9.7</span> The t-test as a special case of the LRT</a>
  <ul class="collapse">
  <li><a href="#tests-of-the-equality-of-group-means" id="toc-tests-of-the-equality-of-group-means" class="nav-link" data-scroll-target="#tests-of-the-equality-of-group-means"><span class="header-section-number">9.7.1</span> Tests of the equality of group means</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction to inference</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="lesson-preamble" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Lesson preamble</h1>
<blockquote class="blockquote">
<h3 id="lesson-objectives" data-number="9.0.1" class="anchored"><span class="header-section-number">9.0.1</span> Lesson objectives</h3>
<ul>
<li>Develop understanding of random variables, probability distributions, and liklihood.</li>
<li>Understand how to simulate realizations of of a random variable.</li>
<li>Develop familarity with maximum liklihood estimation and inference.</li>
<li>Become familar with hypothesis testing: null and alternate hypotheses, test statistics, power, significance, p-values, and the duality of hypothesis tests and confidence intervals.</li>
</ul>
<h3 id="lesson-outline" data-number="9.0.2" class="anchored"><span class="header-section-number">9.0.2</span> Lesson outline</h3>
<ul>
<li>Random variables, probability distributions, and liklihood
<ul>
<li>Interpretations of probability, sources of uncertainty</li>
<li>Discrete vs continuous RVs</li>
<li>Simulating random variables in R</li>
<li>Means, variences, and other moments</li>
</ul></li>
<li>Liklihood estimation and inference
<ul>
<li>Understanding the liklihood function</li>
<li>Mathematical and numerical optimization</li>
</ul></li>
<li>Hypothesis testing: theory and examples</li>
</ul>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">### see other themes here: https://ggplot2.tidyverse.org/reference/ggtheme.html</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="whats-chance-got-to-do-got-to-do-with-it" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="whats-chance-got-to-do-got-to-do-with-it"><span class="header-section-number">9.1</span> What’s chance got to do … got to do … with it?</h2>
<p>Statistics is the study of decision making under uncertainty. Randomness that is inherit in many physical processes (especially those in ecology and evolution) makes it difficult to, given data, choose between alternative explanations for how the world works. But probability theory provides us with tools to combat this uncertainty and to come to principled, informed conclusions.</p>
<p>In this lecture, we will introduce key concepts in probability and statistics. These concepts (e.g., likelihood) form the backbone for future lectures and will be invaluable as you complete your projects.</p>
</section>
<section id="random-variables-and-probability-distributions" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="random-variables-and-probability-distributions"><span class="header-section-number">9.2</span> Random variables and probability distributions</h2>
<p>Consider an experiment which gives rise to a set <span class="math inline">\(\Omega\)</span> of outcomes. This set of outcomes is called the sample space. The space of all is formed by considering all possible combinations of outcomes (or some combinations but not all for technical reasons). Suppose the sample space is <span class="math inline">\(\Omega = \{1,2,3,4\}\)</span>, so that the experiment might be rolling a four-sided die. One event is observing 2 or 3 upon rolling the die: this event is denoted <span class="math inline">\(\{2,3\}\)</span>. (This is only one of many such events!). Probability allows us to assign to each event (<span class="math inline">\(\{2,3\}, \{\}, \{1,2,3,4\}\)</span>, etc.) a value between zero and one capturing how likely that event is to occur under the experiment we have preformed. We also need certain conditions on this function to be met:</p>
<ul>
<li>The probability of any event must be <span class="math inline">\(\geqslant 0\)</span>. Negative probabilities make no sense!</li>
<li>The probability of the event <span class="math inline">\(\Omega\)</span> must be <span class="math inline">\(=1\)</span>. must have happened!</li>
<li>Countably many mutually exclusive events <span class="math inline">\(A_1,A_2,\dots,\)</span> must satisfy the following:</li>
</ul>
<p><span class="math display">\[\Pr (A_1 \text{ and } A_2 \text{ and } A_3 \text{ and } \cdots) = \sum_{i=1}^\infty \Pr (A_i)\]</span></p>
<p><span class="math inline">\(A_1,\dots,A_n,\dots\)</span> are mutually exclusive if <span class="math inline">\(A_i, A_j\)</span> do not share outcomes for all <span class="math inline">\(i \neq j\)</span>. (The events <span class="math inline">\(A_1 = \{1,2\}\)</span> and <span class="math inline">\(A_2 = \{3,4\}\)</span> are distinct, while the events <span class="math inline">\(A_1 = \{1,3\}\)</span> and <span class="math inline">\(A_2 = \{3,4\}\)</span> are not.)</p>
<p>In the case of rolling a four-sided die, the probability of all events can be calculated (due to the extra conditions) by specifying what the probability of each outcome. Suppose <span class="math inline">\(\Pr(\{1\}) = 0.2, \Pr(\{2\}) = 0.3, \Pr(\{3\}) = \Pr(\{4\}) = 0.25\)</span>, i.e., the die is not fair but not horribly biased to one side.</p>
<p>A random variable is ; more precisely, a RV is a function from the sample space to the real numbers. In the above example, the experiment is the roll of a four-sided die and the outcomes are 1,2,3, and 4. The random variable, which we call <span class="math inline">\(X\)</span>, has an associated probability distribution: <span class="math inline">\(\Pr(X = 1) = 0.2, \Pr(X = 2) = 0.3, \Pr(X = 3) = \Pr(X = 4) = 0.25\)</span>. Capital letters are often used to denote random variables and lower case letters to denote the values they can assume (i.e., elements of their range). We can use this probability distribution to simulate realizations (draws) of <span class="math inline">\(X\)</span>, which correspond to repeatedly and independently preforming the experiment:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># = number of experiments (realizations)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>realizations_N_die_rolls <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size =</span> N, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>), </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">replace =</span> T)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>realizations_N_die_rolls</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 4 3 4 2 3 4 1 4 1 2 2 2 4 4 3 4 1 1 1 4 2 3 2 2 4 1 2 4 1 1 4 1 1 1 4 4 4
 [38] 2 3 4 3 2 2 2 2 3 2 1 1 2 4 2 4 2 1 4 2 4 3 1 3 3 3 3 2 1 3 1 4 2 3 3 4 3
 [75] 3 2 3 3 2 3 4 3 1 3 4 4 3 4 4 2 1 1 1 1 3 3 2 2 1 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>realizations_N_die_rolls <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value =</span> realizations_N_die_rolls)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(realizations_N_die_rolls, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> ..count..<span class="sc">/</span>N)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lec07-intro-to-stats_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This example gives rise to a probability distribution on the set <span class="math inline">\(\{1,2,3,4\}\)</span> and, in fact, all of its subsets. Discrete probability distributions like this show up quite often, but so do continuous ones.</p>
<p>For example, a uniform distribution assigns equal weight to all real numbers between, say, <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>. If <span class="math inline">\(X \sim \text{Uniform}(0,1)\)</span>, i.e., <span class="math inline">\(X\)</span> is a random variable with a uniform distribution, then <span class="math inline">\(\Pr(a_1 &lt; X &lt; b_1) = (b_1 - a_1).\)</span> We can simulate realizations of a uniform random variable using</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>realizations_N_uniform <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> N, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>realizations_N_uniform <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value =</span> realizations_N_uniform)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(realizations_N_uniform, <span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> ..count..<span class="sc">/</span>N)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lec07-intro-to-stats_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In general, the distribution of a discrete random variable <span class="math inline">\(X\)</span> (which models an experiment with a countable number of outcomes <span class="math inline">\(1,2,3.\dots\)</span>) is completely determined by the probabilities <span class="math inline">\(\Pr(X = k)\)</span>. These probabilities form the probability mass function for <span class="math inline">\(X\)</span>, i.e., a function which returns how much “mass” is assigned to each outcome. The probabilities of more complex events can be formed by taking sums.</p>
<p>The below code chunk simulates <span class="math inline">\(n\)</span> realizations of a random variable that is 0 with probability <span class="math inline">\(1-p\)</span> and 1 with probability <span class="math inline">\(p\)</span>. Such a random variable is said to have a Bernoulli distribution, or be Bernoulli.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>bernouli <span class="ot">&lt;-</span> <span class="cf">function</span>(p, n){</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">size =</span> n, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>p, p), <span class="at">replace =</span> T))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">bernouli</span>(<span class="fl">0.1</span>, <span class="dv">100</span>) <span class="do">### 100 realizations of a Bernouli(p = 0.1) RV</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0 1 0 0 0 1 0 1 0 0
 [38] 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0
 [75] 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0</code></pre>
</div>
</div>
<p>The distribution of a continuous random variable <span class="math inline">\(Y\)</span> is defined by a function <span class="math inline">\(f(y|\theta)\)</span> called its probability . The probability of an event <span class="math inline">\(A\)</span> (for example, observing a number between 0.3 and 0.7) is</p>
<p><span class="math display">\[\Pr(Y \in A) = \int_A f(y|\theta) \text{d} y.\]</span></p>
<p>For example, if <span class="math inline">\(Y \sim \text{Uniform}(a,b)\)</span>,</p>
<p><span class="math display">\[\Pr(a &lt; Y &lt; b) = \int_a^b \frac{1}{b-a} \text{d} y = \frac{1}{b-a}(b-a) = 1.\]</span></p>
<p><strong>Importantly, it is convenient to use a common notation for the distribution of discrete and continuous random variables. Since sums are special kinds of integrals, we write <span class="math inline">\(X \sim f(x|\theta)\)</span> even if <span class="math inline">\(X\)</span> is discrete.</strong> A list of important probability distribution functions can be found <a href="https://drive.google.com/file/d/1Yt1zB1_ET3RXJ4fdjyxDScsjen5Ti92I/view?usp=sharing">here</a>.</p>
</section>
<section id="means-variances-and-other-moments" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="means-variances-and-other-moments"><span class="header-section-number">9.3</span> Means, variances, and other moments</h2>
<p>Random variables model outcomes from uncertain experiments, and their properties can tell us about what to expect (or how confident we are that certain outcomes will be realized). One way to characterize the behavior of a RV is by considering its mean, variance, and higher moments.</p>
<p><em>The mean (or expected value) of <span class="math inline">\(X \sim f(x|\theta)\)</span> is a measure of central tendency</em>:</p>
<p><span class="math display">\[E(X) = \int_\Omega f(x|\theta) x \text{d} x.\]</span></p>
<p>The mean of a random variable with a Uniform(0,<span class="math inline">\(n\)</span>) distribution is</p>
<p><span class="math display">\[\int_0^n \frac{1}{n} x \text{d} x = \frac{1}{n} \int_0^n x \text{d} x = \frac{1}{n} \frac{x^2}{2} \bigg\lvert_0^n = \frac{1}{n} \frac{n^2}{2} = \frac{n}{2}.\]</span></p>
<p>Let <span class="math inline">\(E(X) = \mu\)</span>. The variance of <span class="math inline">\(X \sim f(x|\theta)\)</span> is <span class="math inline">\(V(X) = E[(X-\mu)^2] = E(X^2) - \mu^2.\)</span> <em>Variance provides a measure of how far <span class="math inline">\(X\)</span> is, on average, from its mean.</em></p>
<section id="higher-moments" class="level3" data-number="9.3.1">
<h3 data-number="9.3.1" class="anchored" data-anchor-id="higher-moments"><span class="header-section-number">9.3.1</span> Higher moments</h3>
<p>The mean and the variance turn out to be two (very important) measures of central tendency and spread, respectively. Higher ``moments” of a random variable <span class="math inline">\(X\)</span> characterize the skewness and other properties of <span class="math inline">\(X\)</span>; these moments are given by <span class="math inline">\(E(X^n)\)</span> for <span class="math inline">\(n = 1,2,\dots\)</span>.</p>
</section>
</section>
<section id="simulating-important-random-variables" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="simulating-important-random-variables"><span class="header-section-number">9.4</span> Simulating important random variables</h2>
<p>We will return to this topic in a later lecture, but simulation of random variables turns out to be an important tool in scientific computing, which allows us to tackle problems that would be difficult to solve otherwise.</p>
<p>In R, simulating realizations from well-known random variables is very easy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -0.3139176 -0.1397117  0.2775813  0.5772223 -0.2754951  0.7106046
 [7] -0.9947281 -0.7123226  0.7948344 -0.4501034</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">## simulates n = 10 realizations of a Uniform(-1,1) RV</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]  0.898699749 -0.797320836  0.782340605 -1.547394599 -2.137716281
  [6]  0.605712152 -0.216589437 -0.679130952  0.817370129 -0.635958642
 [11]  0.313700544  1.957365944  0.723729978 -2.259259783  0.184541222
 [16] -0.400011613  0.363732444 -1.544620055 -0.919154236 -0.041025126
 [21]  0.576016406  1.406309178  0.093932876  1.489484929  0.709943308
 [26] -0.153720011  1.466181847  0.571070303 -0.601614454  1.188388084
 [31]  1.001865120 -0.458991355 -1.529590693  0.182018423 -1.846050177
 [36]  0.238491312 -0.288674583 -0.594432672  0.611666405  0.945567123
 [41]  1.543230123  0.729228013 -1.624648524 -0.223825458 -0.342051876
 [46]  0.210964181  0.510348798  0.805373140 -1.095498391  0.785921941
 [51]  1.361737222  0.010984160 -0.934842476 -1.652974720 -0.487982325
 [56]  0.900962544  1.072104769 -0.228707398 -0.590087031 -0.290733097
 [61] -0.340682436 -1.209972595 -0.918877549 -0.529742545 -0.482376676
 [66] -0.935272994  0.832845710  0.073484005  0.528455559 -0.300970839
 [71] -2.108656917 -0.888804781 -0.523731815  1.447790427  1.794613963
 [76] -0.989952319  0.858337132 -0.993307243  1.287222604 -2.221326860
 [81] -1.585820497  0.147185388  0.051414075 -0.365927848 -1.570642091
 [86] -0.048599234 -1.094723966 -1.496502420 -0.520615423 -0.002999752
 [91] -0.670217278 -0.126578491  0.745240527 -1.118176757  0.365772430
 [96]  1.238840552  0.302876938 -0.334245338 -0.444970605 -0.299001070</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">## simulates n = 100 realizations of a Normal(mean = 0, variance = 1) RV</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="do">## sd stands for standard deviation, and is the sqrt of the variance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The syntax for simulating from well-known random variables (distributions) is <code>r</code> followed by the name of the distribution. For example, if <span class="math inline">\(X \sim \text{Exponential}(\lambda = 3)\)</span>, then we can simulate realizations of <span class="math inline">\(X\)</span> by calling <code>rexp()</code> and specifying <code>rate = 3</code>. The same syntax works for discrete random variables. If <span class="math inline">\(X \sim \text{Poisson}(\lambda = 0.1)\)</span>, then <code>rpois(lambda = 0.1)</code> does the trick!</p>
<p>Importantly, this also provides a means to simulate from RVs with probability distributions that we cannot write down easily. For example, if <span class="math inline">\(X \sim \text{Normal}(0,1)\)</span>, then we can simulate from <span class="math inline">\(X^2 + 6\)</span> as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>X<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  6.494149  8.155716  6.044227  6.123482  6.001961  6.009059 15.096738
 [8]  6.032964  7.088260  7.259709  6.022938  6.318252  6.599161  6.044559
[15]  6.386919  6.345473  7.817499  7.096669  7.933053  6.657692</code></pre>
</div>
</div>
</section>
<section id="all-about-liklihood" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="all-about-liklihood"><span class="header-section-number">9.5</span> All about liklihood!</h2>
<p>So far we have seen:</p>
<ol type="1">
<li><p>Random variables model experiments with uncertain outcomes and come in many flavors. They are the main workhorse of probability and statistics.</p></li>
<li><p>Functions in base R allow us to conveniently and easily simulation realizations (i.e., draws) of many random variables. When the probability distribution of a random variable may be hard to write down, transformations of other random variables may provide a means to generate random numbers.</p></li>
<li><p>The mean, variance, and higher moments are useful summaries of the central tenancy of and variability in a random experiment or process.</p></li>
</ol>
<p><strong>Now, we turn our attention to the central problem of statistics:</strong> determining what processes and parameters gave rise to data (estimation), and quantifying uncertainty in those estimates (inference). <em>Estimation and inference based on the likelihood function is the basis/foundation for most statistical procedures used in the sciences (including Analysis of Variance, fitting mixed models).</em></p>
<section id="the-liklihood-function" class="level3" data-number="9.5.1">
<h3 data-number="9.5.1" class="anchored" data-anchor-id="the-liklihood-function"><span class="header-section-number">9.5.1</span> The liklihood function</h3>
<p>The idea is as follows. Given data <span class="math inline">\(X_1,X_2,\dots,X_n \sim f(x|\theta)\)</span>, we want to estimate <span class="math inline">\(\theta\)</span>, i.e., to determine what parameters were mostly likely to have given rise to the data (). We do this by maximizing the likelihood function</p>
<p><span class="math display">\[L(X_1,\dots,X_n|\theta) = f(X_1|\theta) \cdots f(X_n|\theta) = \prod_{i=1}^n f(X_i|\theta),\]</span></p>
<p>which is formed the assumption <span class="math inline">\(X_1,\dots,X_n\)</span> are independent. (There are methods that accommodate for dependent data, but we will not get into them here.) <strong>The likelihood function is a function of the parameters <span class="math inline">\(\theta\)</span>, but not of the data. It contains all of the information in the data about the parameters. The likelihood is formed by simply from which they jointly arose.</strong> When the data are independent, the joint probability distribution function is the product of the individual distribution functions.</p>
<p>Viewed as a function of <span class="math inline">\(\theta\)</span>, the likelihood tells us how likely each set of parameter values is to have given rise to the data. The set of parameter values which jointly maximize <span class="math inline">\(L\)</span> (i.e., have the highest likelihood of generating the observed data) is called the maximum likelihood estimator <span class="math inline">\(\hat{\theta}_{\text{MLE}}\)</span>.</p>
</section>
<section id="an-example-of-maximum-liklihood-estimation" class="level3" data-number="9.5.2">
<h3 data-number="9.5.2" class="anchored" data-anchor-id="an-example-of-maximum-liklihood-estimation"><span class="header-section-number">9.5.2</span> An example of maximum liklihood estimation</h3>
<p>Suppose <span class="math inline">\(X_1, X_2, \dots, X_n \sim \text{Exponential}(\lambda)\)</span>. The probability distribution for an Exponential random variable is <span class="math inline">\(f(x|\lambda) = \lambda e^{-\lambda x}\)</span>, where <span class="math inline">\(x \geqslant 0\)</span>. The likelihood function for <span class="math inline">\(\lambda\)</span> is</p>
<p><span class="math display">\[L(X_1,\dots,X_n|\lambda) = \prod_{i=1}^n \lambda e^{-\lambda X_i} = \lambda^n e^{-\lambda (X_1+\dots+X_n)}.\]</span></p>
<p>This appears difficult to maximize, but it turns out that it is quite easy if we take the log of the likelihood. The point at which the likelihood is greatest is not changed under this transformation (since log is an increasing function). The log-likelihood is a bit easier to deal with, and has some nice statistical properties.</p>
<p>With Exponential(<span class="math inline">\(\lambda\)</span>) data, the log-likelihood function is</p>
<p><span class="math display">\[\ln L(X_1,\dots,X_n|\lambda) =  \ln \lambda^n e^{-\lambda (X_1+\dots+X_n)} = n \ln \lambda - \lambda (X_1+\cdots + X_n).\]</span></p>
<p>Now, it is possible to maximize this function with respect to <span class="math inline">\(\lambda\)</span> without too much hassle. Taking the derivative with respect to <span class="math inline">\(\lambda\)</span>, setting it equal to zero, and solving for <span class="math inline">\(\lambda\)</span>, one has</p>
<p><span class="math display">\[\hat{\lambda}_{\text{MLE}} = \frac{n}{(X_1+\dots+X_n)} = \frac{1}{\overline{X}}.\]</span></p>
<p>This shows that the “best” (maximum likelihood) estimator of <span class="math inline">\(\lambda\)</span> is the inverse of the sample mean! Importantly, the estimator is a function of the data and is thus random—this means the estimator has a distribution that is set by the distribution of the data.</p>
<p>To see this, we can do a quick simulation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>exponential_MLE <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">lambda =</span> <span class="dv">5</span>){</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="at">rate =</span> lambda)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(data)) <span class="do">### this is our maximum likelihood estimator</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">exponential_MLE</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.038198</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>estimator <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="do">### number of n=100 exponential draws</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  estimator[i] <span class="ot">&lt;-</span> <span class="fu">exponential_MLE</span>(<span class="at">n =</span> <span class="dv">1000</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>estimator <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value =</span> estimator)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(estimator, <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">fill =</span> <span class="st">"gray"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(estimator<span class="sc">$</span>value), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(estimator<span class="sc">$</span>value) <span class="sc">-</span> <span class="fu">sd</span>(estimator<span class="sc">$</span>value), </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(estimator<span class="sc">$</span>value) <span class="sc">+</span> <span class="fu">sd</span>(estimator<span class="sc">$</span>value), </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lec07-intro-to-stats_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Importantly, the distribution of <span class="math inline">\(\hat{\lambda}_{\text{MLE}}\)</span> is approximately normal for large <span class="math inline">\(n\)</span>, and has mean equal to the true value of <span class="math inline">\(\lambda\)</span>. When R returns a confidence interval, it often makes use of the asymptotic distribution of the maximum liklihood estimator (even when the assumption of a large sample size is not satified).</p>
</section>
<section id="an-aside-numerical-evaluation-of-the-liklihood" class="level3" data-number="9.5.3">
<h3 data-number="9.5.3" class="anchored" data-anchor-id="an-aside-numerical-evaluation-of-the-liklihood"><span class="header-section-number">9.5.3</span> An aside: numerical evaluation of the liklihood</h3>
<p>Often, it is not possible to use calculus to maximize the likelihood function. Sometimes it is not even possible to write down a closed form for the likelihood! In this case, we can use numerical methods to evaluate and maximize the likelihood. The following code chunk illustrates how to do this when the data arise from a mixture of two Normal distributions: <span class="math inline">\(X \sim \text{Normal}(\mu,\sigma^2)\)</span> with probability <span class="math inline">\(p\)</span> and <span class="math inline">\(X \sim \text{Normal}(\nu,\tau^2)\)</span> with probability <span class="math inline">\(1-p\)</span>. The probability distribution function for this data is</p>
<p><span class="math display">\[f(x|\mu,\sigma^2,\nu,\tau^2) = p \frac{1}{\sqrt{2\pi \sigma^2}} e^{-(x-\mu)^2/2\sigma^2} + (1-p) \frac{1}{\sqrt{2\pi \tau^2}} e^{-(x-\nu)^2/2\tau^2}.\]</span></p>
<p>In the below code chunk, <span class="math inline">\(p = 0.1\)</span>, <span class="math inline">\(\mu = 0, \nu = 10, \sigma = 1, \tau = 10\)</span>. We assume that we know <span class="math inline">\(p\)</span> and <span class="math inline">\(\sigma^2\)</span>, and use numerical methods to evaluate the likelihood function across different combinations of parameters. The MLEs for <span class="math inline">\(\mu, \nu,\)</span> and <span class="math inline">\(\tau\)</span> is found by determining where the log-likelihood assumes a maximum.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fl">0.1</span><span class="sc">*</span><span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fl">0.9</span><span class="sc">*</span><span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">10</span>))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>return_LL_at_given_set_parameters <span class="ot">&lt;-</span> <span class="cf">function</span>(parameters){</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># parameters is a vector with values at which evaluate the likelihood</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># contains value for normal means and standard deviations</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  liklihood_each_observation <span class="ot">&lt;-</span> </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.1</span><span class="sc">*</span><span class="fu">dnorm</span>(data, <span class="at">mean =</span> parameters<span class="sc">$</span>mean1, <span class="at">sd =</span> parameters<span class="sc">$</span>sd1) <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.9</span><span class="sc">*</span><span class="fu">dnorm</span>(data, <span class="at">mean =</span> parameters<span class="sc">$</span>mean2, <span class="at">sd =</span> parameters<span class="sc">$</span>sd2) </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># this is the prob. dist of the data, but will look different depending on the application</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  LL_at_given_theta <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">log</span>((liklihood_each_observation)))</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(LL_at_given_theta)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>LL <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>values_to_test <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">mean1 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="sc">-</span><span class="fl">0.1</span>,<span class="dv">0</span>,<span class="fl">0.1</span>,<span class="fl">0.5</span>),</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mean2 =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>,<span class="at">by=</span><span class="fl">0.5</span>),</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd1 =</span> <span class="dv">1</span>, <span class="at">sd2 =</span> <span class="fu">seq</span>(<span class="dv">5</span>,<span class="dv">15</span>,<span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(values_to_test)){</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  parameters <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(values_to_test[i,])</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  LL[i] <span class="ot">&lt;-</span> <span class="fu">return_LL_at_given_set_parameters</span>(parameters)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>log_liklihood <span class="ot">&lt;-</span> </span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(LL, values_to_test)) <span class="sc">%&gt;%</span> <span class="fu">subset</span>(<span class="fu">is.finite</span>(LL))</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="do">### returns which parameters gave rise to max likelihood</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>MLE <span class="ot">&lt;-</span> log_liklihood <span class="sc">%&gt;%</span> <span class="fu">subset</span>(LL <span class="sc">==</span> <span class="fu">max</span>(LL)); MLE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             LL mean1 mean2 sd1 sd2
20148 -3672.469     0    10   1 9.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>log_liklihood <span class="sc">%&gt;%</span> <span class="fu">subset</span>(mean1 <span class="sc">==</span> MLE<span class="sc">$</span>mean1 <span class="sc">&amp;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                         mean2 <span class="sc">==</span> MLE<span class="sc">$</span>mean2 <span class="sc">&amp;</span> sd1 <span class="sc">==</span> MLE<span class="sc">$</span>sd1) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sd2, <span class="at">y =</span> LL)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> MLE<span class="sc">$</span>sd2, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"tau"</span>, </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"log-liklihood (fixing all other parameters at their MLEs)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lec07-intro-to-stats_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">## this shows the *profile* likelihood, a slice of the full likelihood</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="do">## mu, sigma, and nu are fixed at their MLEs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="hypothesis-testing-theory" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="hypothesis-testing-theory"><span class="header-section-number">9.6</span> Hypothesis testing: theory</h2>
<p>Often, the objective of a study is not to estimate a parameter but to decide which of two (or more) contradictory claims about the parameter is consistent with the data. This part of statistics is called . Hypothesis testing is intimately connected to the construction and interpretation of confidence intervals which quantify estimation uncertainty.</p>
<section id="null-and-alternative-hypotheses" class="level3" data-number="9.6.1">
<h3 data-number="9.6.1" class="anchored" data-anchor-id="null-and-alternative-hypotheses"><span class="header-section-number">9.6.1</span> Null and alternative hypotheses</h3>
<p>A statistical hypothesis is an assertion about the values of one or more parameters, or the form of a probability distribution that is used to model the data.</p>
<p>Two contradictory hypotheses of the first kind are</p>
<p><span class="math display">\[H_0: \theta = \theta_0\]</span> <span class="math display">\[H_1: \theta \neq \theta_0\]</span></p>
<p>The first hypothesis is called the and may correspond to an expectation we have about the parameter (from, e.g., prior data). The second hypothesis is called the . The data are used to make a principle conclusion about if the null hypothesis is consistent with the data; if so, we reject the alternative hypothesis and, if not, we reject the null hypothesis as an explanation for the data generative process. In the following sections, we will describe the process for conducting such a hypothesis test.</p>
</section>
<section id="test-statistics" class="level3" data-number="9.6.2">
<h3 data-number="9.6.2" class="anchored" data-anchor-id="test-statistics"><span class="header-section-number">9.6.2</span> Test statistics</h3>
<p>Suppose we have data <span class="math inline">\(X_1,\dots,X_n \sim f(x|\theta)\)</span> and wish to test the above hypotheses, i.e., to decide if <span class="math inline">\(\theta \neq \theta_0\)</span>. We do this by constructing a test statistic, i.e., function of the data, and assessing if the realized value of statistic is consistent with its distribution under the null hypothesis. Is the value of the statistic, at some level of significance, different from what we would expect if the null hypothesis were true?</p>
<p>Many choices of test statistic are possible, but the likelihood ratio is one that is commonly used:</p>
<p><span class="math display">\[\lambda_{LR} = -2 (\ln L(\theta_0)-\ln L(\hat{\theta}_{\text{MLE}})).\]</span></p>
<p>The statistic is based on the likelihood function, and its asymptotic distribution (as the sample size becomes large) under the null hypothesis is known. <span class="math inline">\(\lambda_{LR}\)</span> has an approximate <span class="math inline">\(\chi^2\)</span> distribution under <span class="math inline">\(H_0\)</span>. (<em>Importantly, one must know the approximate distribution of a test statistic to preform a hypothesis test.</em>) Given the value and distribution of our test statistic under the null hypothesis, we can determine which two competing hypothesis is consistent with the data.</p>
</section>
<section id="how-do-we-do-this" class="level3" data-number="9.6.3">
<h3 data-number="9.6.3" class="anchored" data-anchor-id="how-do-we-do-this"><span class="header-section-number">9.6.3</span> How do we do this?</h3>
<p>To decide between the null and alternative hypothesis, given a test statistic and its distribution under <span class="math inline">\(H_0\)</span>, we must specify a <span class="math inline">\(\alpha\)</span>. The significance level measures how likely we are to reject the null hypothesis, given that it is true: <span class="math inline">\(\alpha = P(\text{reject } H_0 | H_0)\)</span>. The significance level is chosen , and is typically set to 0.05 or smaller. By a similar token, the of a statistical test is defined as the probability of rejecting the alternative hypothesis, given it is true: <span class="math inline">\(1-\beta = \Pr(\text{reject } H_0 | H_1).\)</span> Many factors affect the power of a test, but a test based on the likelihood ratio test statistic is the uniformly most powerful among all alternatives to test the above hypothesis. In general, one can preform (and it is best practice to preform!) analyses ahead of data collection to ensure power at a certain level.</p>
<p><strong>We conduct a hypothesis test at significance level <span class="math inline">\(\alpha\)</span> as follows:</strong></p>
<ol start="0" type="1">
<li>State the null and alternative hypothesis and significance level <span class="math inline">\(\alpha\)</span>.</li>
<li>Collect data, possibly with knowledge of the sample size required to achieve a certain power.</li>
<li>Calculate the realized value <span class="math inline">\(s\)</span> of a test statistic <span class="math inline">\(S\)</span>, e.g., <span class="math inline">\(\lambda_{LR}\)</span>. The test statistic must have a known distribution under the null hypothesis. The likelihood ratio has a <span class="math inline">\(\chi^2\)</span> distribution under <span class="math inline">\(H_0\)</span> above.</li>
<li>Compute the probability of observing the realized value of the test statistic or something more extreme, given the null hypothesis is true, i.e., <span class="math inline">\(p = \Pr(S &gt; s | H_0)\)</span>. This probability is called a <span class="math inline">\(p\)</span> value. If <span class="math inline">\(p &lt; \alpha\)</span>, we reject the null hypothesis at significance level <span class="math inline">\(\alpha\)</span> and, if not, we fail to reject <span class="math inline">\(H_0\)</span>.</li>
</ol>
<p>To illustrate how this works, we will return to the previous example. A test of <span class="math inline">\(H_0: (\mu,\sigma,\nu,\tau) = (0,1,10,10)\)</span> vs <span class="math inline">\(H_1: (\mu,\sigma,\nu,\tau) \neq (0,1,10,10)\)</span> at significance level <span class="math inline">\(\alpha = 0.05\)</span> can be preformed as follows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>liklihood_at_null <span class="ot">&lt;-</span> log_liklihood <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(mean1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> mean2 <span class="sc">==</span> <span class="dv">10</span> <span class="sc">&amp;</span> sd1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> sd2 <span class="sc">==</span> <span class="dv">10</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>test_statistic <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(liklihood_at_null<span class="sc">$</span>LL <span class="sc">-</span> MLE<span class="sc">$</span>LL) </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>test_statistic <span class="do">### realized value of the likelihood ratio test statistic</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.009804945</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(test_statistic, <span class="at">df =</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9211225</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">### if p &lt; 0.05, then we reject H0; otherwise, we fail to reject H0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since we have designed <span class="math inline">\(H_0\)</span> so that it is true (i.e., the values for the parameters are those used to generate the data), it should come as no surprise that we fail to reject the null hypothesis in favour of <span class="math inline">\(H_1\)</span>.</p>
<p>In contrast, consider the test <span class="math inline">\(H_0: (\mu,\sigma,\nu,\tau) = (0,1,10,0)\)</span> vs <span class="math inline">\(H_1: (\mu,\sigma,\nu,\tau) \neq (0,1,10,5)\)</span>. In this case, <span class="math inline">\(p &lt; \alpha\)</span>, so that we have sufficient evidence to reject the null hypothesis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>liklihood_at_null <span class="ot">&lt;-</span> log_liklihood <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(mean1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> mean2 <span class="sc">==</span> <span class="dv">10</span> <span class="sc">&amp;</span> sd1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> sd2 <span class="sc">==</span> <span class="dv">5</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>test_statistic <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(liklihood_at_null<span class="sc">$</span>LL <span class="sc">-</span> MLE<span class="sc">$</span>LL) </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>test_statistic <span class="do">### realized value of the likelihood ratio test statistic</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1384.845</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(test_statistic, <span class="at">df =</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.127566e-303</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="do">### if p &lt; 0.05, then we reject H0; otherwise, we fail to reject H0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="confidence-intervals" class="level3" data-number="9.6.4">
<h3 data-number="9.6.4" class="anchored" data-anchor-id="confidence-intervals"><span class="header-section-number">9.6.4</span> Confidence intervals</h3>
<p>One way to think of a <span class="math inline">\(100(1-\alpha)\%\)</span> confidence interval is as the set of values <span class="math inline">\(\theta_0\)</span> such that we fail to reject the hypothesis <span class="math inline">\(\theta = \theta_0\)</span> at significance level <span class="math inline">\(\alpha\)</span>. (There are other ways to define and understand confidence intervals but they are somewhat oblique.) Depending on the application, it may be more convenient to do a hypothesis test or to construct a confidence interval. Unlike hypothesis tests, confidence intervals quantify the uncertainty around point estimates like the MLE. There are many ways to construct confidence intervals, but below we show one that involves finding which <span class="math inline">\(\theta_0\)</span> are such that <span class="math inline">\(\lambda_{LR} -2(\ln L(\theta_0)-\ln L(\hat{\theta}_{\text{MLE}})) &lt; \chi^2_c\)</span>, where <span class="math inline">\(\chi^2_c\)</span> a cutoff based on <span class="math inline">\(100(1-\alpha)\%\)</span>-ile for a <span class="math inline">\(\chi^2\)</span> distribution with one degree of freedom.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="fl">0.95</span>,<span class="at">df=</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># cutoff for admissible values based on 95%-ile for a chi-squared dist df=1</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>log_liklihood <span class="sc">%&gt;%</span> <span class="fu">subset</span>(mean1 <span class="sc">==</span> MLE<span class="sc">$</span>mean1 <span class="sc">&amp;</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                         mean2 <span class="sc">==</span> MLE<span class="sc">$</span>mean2 <span class="sc">&amp;</span> sd1 <span class="sc">==</span> MLE<span class="sc">$</span>sd1) <span class="ot">-&gt;</span> LL_plot</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>LL_plot <span class="sc">%&gt;%</span> <span class="fu">subset</span>(<span class="fu">abs</span>(LL <span class="sc">-</span> MLE<span class="sc">$</span>LL) <span class="sc">&lt;</span> cutoff) <span class="ot">-&gt;</span> values_inconfidence_interval</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">min</span>(values_inconfidence_interval<span class="sc">$</span>sd2),</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(values_inconfidence_interval<span class="sc">$</span>sd2)) <span class="do">### confidence interval!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  9.6 10.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>LL_plot <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sd2, <span class="at">y =</span> LL)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> MLE<span class="sc">$</span>sd2, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">min</span>(values_inconfidence_interval<span class="sc">$</span>sd2), </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">max</span>(values_inconfidence_interval<span class="sc">$</span>sd2), </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"tau"</span>, <span class="at">y =</span> <span class="st">"log-liklihood (all other parameters at their MLEs)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lec07-intro-to-stats_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The limits for the <span class="math inline">\(95\%\)</span> confidence interval for <span class="math inline">\(\tau\)</span> are given by the dashed red lines. As before, the maximum likelihood estimate for <span class="math inline">\(\tau\)</span> (with all other parameters fixed at their MLEs) is represented by the solid red line.</p>
</section>
</section>
<section id="the-t-test-as-a-special-case-of-the-lrt" class="level2" data-number="9.7">
<h2 data-number="9.7" class="anchored" data-anchor-id="the-t-test-as-a-special-case-of-the-lrt"><span class="header-section-number">9.7</span> The t-test as a special case of the LRT</h2>
<p>Most of the tests that are presented in introductory statistics courses are special cases of the likelihood ratio test, or approximations to the LRT. Consider the t-test: <span class="math inline">\(H_0: \mu = \mu_0\)</span> vs <span class="math inline">\(H_1: \mu \neq \mu_0\)</span>. The <span class="math inline">\(t\)</span>-test assumes the data <span class="math inline">\(X_1,\dots,X_n\)</span> are independent and normally distributed with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>.</p>
<p>Under these assumptions, the likelihood ratio test statistic is of the form</p>
<p><span class="math display">\[\lambda_{LR} = \bigg( 1 + \frac{t^2}{n-1} \bigg)^{-n/2},\]</span></p>
<p>where</p>
<p><span class="math display">\[t = \frac{\sqrt{n} (\overline{x} - \mu_0)}{S}\]</span></p>
<p>and</p>
<p><span class="math display">\[S^2 = \frac{1}{n-1} \sum_{i=1}^n (x_i - \overline{x})^2.\]</span></p>
<p><span class="math inline">\(S^2\)</span> is an unbiased estimator of the population variance. (The ML estimator is biased, so it is corrected and the unbiased estimator is used in calculating the test statistic.) The corresponding LR is based on the statistic <span class="math inline">\(t\)</span>, which has an approximate <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(n-1\)</span> degrees of freedom.</p>
<p><em>A <span class="math inline">\(t\)</span> test assesses if there is evidence to reject <span class="math inline">\(H_0\)</span> based on the realized value of <span class="math inline">\(t\)</span> and knowledge of its approximate (asymptotic) distribution. As before, this involves calculating the realized value of the statistic and determining the probability of observing data more extreme under the null hypothesis; if this value is <span class="math inline">\(&lt; \alpha\)</span>, the null hypothesis is rejected at significance <span class="math inline">\(\alpha\)</span>.</em> Importantly, any test based on the statistic <span class="math inline">\(t\)</span> can be formulated in terms of the likelihood ratio; in this way, the <span class="math inline">\(t\)</span> test is a special case of the LRT.</p>
<p>The <code>t.test</code> function implements several variants of the <span class="math inline">\(t\)</span>-test in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="co"># change mean to 0.25, 0.3</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(data, <span class="at">mu =</span> <span class="fl">0.25</span>, <span class="at">conf.level =</span> <span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  data
t = -3.0997, df = 99, p-value = 0.002522
alternative hypothesis: true mean is not equal to 0.25
1 percent confidence interval:
 -0.07496211 -0.07233818
sample estimates:
  mean of x 
-0.07365014 </code></pre>
</div>
</div>
<section id="tests-of-the-equality-of-group-means" class="level3" data-number="9.7.1">
<h3 data-number="9.7.1" class="anchored" data-anchor-id="tests-of-the-equality-of-group-means"><span class="header-section-number">9.7.1</span> Tests of the equality of group means</h3>
<p>With a one-sample <span class="math inline">\(t\)</span>-test, you’re asking whether the mean of your sample differs significantly from a mean value that you expect it to have. You might want to use this if you have an expected population mean value from the literature. You may have even amassed your own dataset that you think is representative of a population’s true mean &amp; you want to compare a newly collected sample. To determine if there are differences between <em>group means</em>, a two-sample <span class="math inline">\(t\)</span>-test can be used:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>obs1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>obs2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="co"># note difference in sample size</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(obs1, obs2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  obs1 and obs2
t = -9.4628, df = 122.24, p-value = 2.828e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -1.1626865 -0.7603914
sample estimates:
 mean of x  mean of y 
0.02663763 0.98817658 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">### alternatively, one can use the following syntax:</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(<span class="fu">cbind</span>(<span class="at">obs =</span> obs1, <span class="at">ID =</span> <span class="dv">1</span>), </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">cbind</span>(<span class="at">obs =</span> obs2, <span class="at">ID =</span> <span class="dv">2</span>)))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(obs<span class="sc">~</span>ID, data) <span class="do">### the syntax will be the same for linear models!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  obs by ID
t = -9.4628, df = 122.24, p-value = 2.828e-16
alternative hypothesis: true difference in means between group 1 and group 2 is not equal to 0
95 percent confidence interval:
 -1.1626865 -0.7603914
sample estimates:
mean in group 1 mean in group 2 
     0.02663763      0.98817658 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(lm(obs~ID, data))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When the goal of an investigation is to test if mean values of a dependent variable are different between categories that were <em>paired by design</em>, a paired <span class="math inline">\(t\)</span>-test is used. An example where this would be appropriate is an experiment in which Daphnia abundance was sampled before and after exposure to a pathogen.</p>
<p>The syntax for a paired <span class="math inline">\(t\)</span>-test is as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(obs1, obs2, <span class="at">paired=</span><span class="cn">TRUE</span>) <span class="do">## sample sizes must be equal here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the next assignment, you will be asked to apply content from this lecture, and to read some notes on other tests (chi square, permutation, etc.) that are commonly used in ecology and evolution. Be on the lookout for these notes, which will be on Quercus and <a href="eeb313.github.io">eeb313.github.io</a> soon.</p>
<p><img src="figures/hypothesistesting.png" class="img-fluid"></p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./lec06-exploratory-data-analysis.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Exploratory data analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./projects.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Project description</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>